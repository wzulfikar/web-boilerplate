## Tech Stack

These are the technology we use in this repo. 

- Next.js for both back end and front end
- Supabase for the database. The SQL migration files are stored in `supabase/migrations/`
- Tailwind (v4) for styling
- ShadCN for component building block. For ShadCN components that we use often, we may add "simple" variant in the component file. For example, the `components/ui/breadcrumb.tsx` contains the original ShadCN code AND the `BreadcrumbSimple` component which we added.
- Biome for formatter and linter. We try to use the latest biome version, which is reflected in its config file at `biome.json`.
- Bun (`bun`) for package manager, script runner, test runner. We don't use npx, npm, pnpm, or yarn.
- Lefthook for pre-commit checks
- Github Action for CI/CD. 
- MCP to help AI agents. The MCP servers are exposed via editor integration (like Zed). Examples of available MCP:
  - use context7 to get the updated documentation of our tech stack
  - use nextjs MCP to interact with Next.JS development server

**Architecture Overview**

The Next.js codes are centralized in `src/app` so we can treat it as a thin wrapper for our logic. It can contain a bit of back end codes, like in the `src/app/api`, but it should only act as the plumbing between Next.js to our actual logic. The real back end codes are centralized in `server/`. 

The codebase is not a monorepo, but we're separating the directory based on concerns. Example:
- `commands`: contains ad-hoc commands to manage the app, e.g. for administration tasks
- `emails`: contains email templates
- `scripts`: contains scripts to manage the codebase, e.g. for development-related tasks like deployment, etc.
- `server`: contains back end codes (server codes). This is where our business logic stored, which then plumbed into the app either through `src/app` (for Next.js) or `trigger/` (for backend jobs).
- `shared`: contains codes that are reusable across runtime (back end or front end)
- `src`: contains front end codes and the main app, Next.js, at `src/app/` (we use App Router)
- `supabase`: contains supabase codes like SQL migrations, custom schema
- `tests`: contains test codes, with folders structured to parallel the tested codes. For example, `tests/server/` contains test codes for server codes, `tests/src/` contains test codes for front end codes.
- `trigger`: contains codes for background tasks. The name is "trigger" because we use trigger.dev to handle background tasks.

Some commands we use for development are expected to be available globally in the developer machine, example: bun, biome, tsgo.

**Coding Convention**

- endpoints
- apiClient
- error utils (via saas-maker): throwIf, Result type

**Coding Approach**

- Scope and isolate
- Safety and clarity. Don't add comments everywhere, developers are senior engineers

## Common Scripts

These are the scripts we commonly run during development.

- `bun i <package_name>`: Install a package
- `bun cn add <component_name>`: Add a new ShadCN component
- `bun check`: Run static check (type checking, format checking, and linting). Run this after making code changes to make sure that the changes don't accidentally break other part of the app.
- `bun test`: Run tests
